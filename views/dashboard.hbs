<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>{{title}}</title>
    <!--Stylesheets-->
    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel="stylesheet" href="/font-awesome-4.7.0/css/font-awesome.min.css" />

    <link rel="stylesheet" href="/css/main.css" />
    <link rel="stylesheet" href="/css/mystyle.css" />
    <link rel="stylesheet" href="/css/style.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
  </head>
  <body class="index">
    <!--Navbar--> 
    {{> user_nav}}
    <!--Hero-->
    <div class="jumbotron">
      <div class="container">
        <div class="profile">
          <img src="/img/profile1.jpg" alt="profile" class="profile-img" />
          <div class="profile-name"><p>{{user.username}}</p></div>
        </div>
        <button type="button" id="upload" style="width:25%;" class="btn btn-warning">
          Upload Picture
        </button>
        <input type="file" name="profile_pic" id="profile_pic" style="display:none;">
      </div>
    </div>
    <!--Double columns-->
    <div class="double-column">
      <div class="container">
        <div class="row">
          <div class="col-sm-12">
            <div class="row">
              <div class="actions col-sm-4">
                <button
                  type="button"
                  class="btn btn-primary"
                  style="margin:25px 0px;"
                >
                  <img
                    src="/images/icons/fun-fact-color1.png"
                    alt="images"
                    class="img-responsive center-block "
                    style="margin-bottom: 10px ;"
                  />
                  Total job done
                </button>
                <span class="fa"> {{allReviews.length}} </span>
              </div>

              <div class="actions col-sm-4">
                <button
                  type="button"
                  class="btn btn-primary"
                  style="margin:25px 0px;"
                >
                  <img
                    src="/images/icons/fun-fact-color2.png"
                    alt="images"
                    class="img-responsive center-block "
                    style="margin-bottom: 10px ;"
                  />
                  Positive reviews
                </button>
                <span class="fa">{{positiveReviews.length}}</span>
              </div>

              <div class="actions col-sm-4">
                <button
                  type="button"
                  class="btn btn-primary"
                  style="margin:25px 0px;"
                >
                  <img
                    src="/images/icons/fun-fact-color3.png"
                    alt="images"
                    class="img-responsive center-block "
                    style="margin-bottom: 10px ;"
                  />
                  Negative reviews
                </button>
                <span class="fa">{{negativeReviews.length}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="tr-profile container section-padding">
      <div class="row">


        <div class="col-sm-5 col-md-4">
          <div class="title secColor whitefont">
            <!-- <div class="icon"><img src="images/icons/2.png" alt="Icon" class="img-responsive"></div>  -->
            <h4 class="myTitle"><b> <i class="fa fa-home fa-2x" aria-hidden="true"></i> Home  </b></h4>
          </div>

          <ul class="nav nav-tabs profile-tabs section" role="tablist">
            <li role="presentation" class="active">
              <a
                href="#account-info"
                aria-controls="account-info"
                role="tab"
                data-toggle="tab"
                ><i class="fa fa-life-ring" aria-hidden="true"></i> Hire  Job
                Seeker
              </a>
            </li>


            <li role="presentation">
                <a
                  href="#edit-resume"
                  aria-controls="edit-resume"
                  role="tab"
                  data-toggle="tab"
                  ><span
                    ><i class="fa fa-pencil-square-o" aria-hidden="true"></i
                  ></span>
                  Manage  Profile
                </a>
              </li>

        

            <!-- <li role="presentation" >
              <a
                href="#account-info"
                aria-controls="account-info"
                role="tab"
                data-toggle="tab"
                ><i class="fa fa-life-ring" aria-hidden="true"></i> Manage Bank
                Account</a
              >
            </li> -->

           
            <li role="presentation">
              <a
                href="#edit-resume"
                aria-controls="edit-resume"
                role="tab"
                data-toggle="tab"
                ><span
                  ><i class="fa fa-pencil-square-o" aria-hidden="true"></i
                ></span>
                Manage Subscriptions
              </a>
            </li>


            <li role="presentation">
                    <a
                      href="#edit-resume"
                      aria-controls="edit-resume"
                      role="tab"
                      data-toggle="tab"
                      ><span
                        ><i class="fa fa-pencil-square-o" aria-hidden="true"></i
                      ></span>
                      Manage Reviews
                    </a>
                  </li>

           
          </ul>
        </div>

        <div class="col-sm-7 col-md-8">


         <div id="Dashboard_View">
                    <div id="ProfileInfo" class="displayinformation">
                      <div class="title title-after secColor whitefont">
                      
                        <h4 class="myTitle"><b>Profile Summary </b></h4>
                      </div>

                      <div class="media-body LR_Padding">
                        <span id="AboutMe" class="tr-title">About Me </span>
                          {{#if userProfile._about}}
                            {{userProfile._about}}
                          {{else}}
                            <p>Sorry, we have nothing about you. Please update your profile here.</p>
                          {{/if}}
                        <br />
                       
                      </div>
                    </div>

                    <div id="JobCategoriesInfo" class="displayinformation">
                      <div class="title title-after secColor whitefont">
                        <!-- <div class="icon"><img src="images/icons/2.png" alt="Icon" class="img-responsive"></div>  -->
                        <h4 class="myTitle"><b> List of what i can Do </b></h4>
                      </div>
                    {{#if hasServices}}
                       <ul id="ul_Interests" class="list-inline">
                         {{#each userDetails.services as |service|}}
                           <li id="{{service.id}}">
                              <button class="btn btn-primary">
                                <i class="fa fa-star" aria-hidden="true"></i> {{service.name}}
                              </button>
                            </li>
                         {{/each}}
                        
                      </ul>
                    {{else}}
                      <p>You have not selected any service yet, please update your profile</p>
                    {{/if}}
                     
                    </div>

                    <div id="ContactInfo" class="displayinformation">
                                          <div class="title title-after secColor whitefont">
                                          <!-- <div class="icon"><img src="images/icons/2.png" alt="Icon" class="img-responsive"></div>  -->
                                          <h4 class="myTitle"><b> Contact Information </b></h4>
                                          </div>
                                        

                                          <div id="div_Contact" class="LR_Padding">

                                              <div class="LR_Padding">
                                              
                                                      <h4 class="contact">Address :</h4>
                                                      {{#if userProfile.address}}
                                                        <p>
                                                          {{ userProfile.address }}
                                                        </p>
                                                      {{else}}
                                                          <p>No address available, please update your status</p>
                                                      {{/if}}
                                                      
                                              <p>
                                                      <h4 class="contact">School :</h4>
                                                      {{userDetails.school.name}}, {{userDetails.school.location}}
                                                    
                                              </p>

                                              <p>
                                                      <h4 class="contact"> Email & Phone Number:</h4>
                                                    {{userDetails.email}} , 
                                                    {{userDetails.phone}}
                                              </p>
                                              <p>
                                                  <h4 class="contact">Contact description</h4>
                                                 <h5 class="contact">
                                                   <b>WhatsApp:</b>
                                                   {{#if userProfile.whatsapp}}
                                                    {{userProfile.whatsapp}}
                                                  {{else}}
                                                    Not set
                                                  {{/if}}
                                                    </h5>                                                 
                                              </p>

                                              </div>
                                            
                                            
                                          </div>
                                          <hr/>
                          
                                          <div class="updated-info LR_Padding">
                                              <span class="pull-left">Last Login Date </span>
                                              <span class="pull-right">{{moment userDetails.lastlogin "DD/MM/YYYY"}}</span>
                                          </div>
                    </div>


                    <div id="ReviewsInfo" class="displayinformation">

                                  <div class="title title-after secColor whitefont">
                                          <!-- <div class="icon"><img src="images/icons/2.png" alt="Icon" class="img-responsive"></div>  -->
                                          <h4 class="myTitle"><b> Top Reviews </b></h4>
                                          </div>


                                        
                                          <div  id="reviews" class="LR_Padding">   
                                            <ul class="list-inline LR_Padding"> 
                                              {{#each allReviews as |review|}}
                                                <li>
                                                  <p>
                                                        <i class="fa fa-user-circle fa-3x" aria-hidden="true"></i> 
                                                        <b> {{review._reviewer.username}} (CSE-400level)</b><br/>
                                                       {{review.comment}}
                                                  </p> 
                                                </li>  
                                                <br>
                                              {{/each}}
                                              
                                              
                                            </ul>	

                                          </div>
                                          <hr/>

                                          <div class="updated-info LR_Padding">
                                                  <span class="pull-left">Last Login Date </span>
                                                  <span class="pull-right">{{moment userDetails.lastlogin "DD/MM/YYYY"}}</span>
                                              </div>

                                      

                  </div>
         </div>


         <div id="ProfileManage_View">
                  <div>

                      <div class="page-title blueback" style="padding:30px; border-radius: 5px 5px 5px 5px;">
                          <h3> Member Profile </h3>
                      </div>

                      <div class="section display-information">
                          <div class="title title-after">

                              <span class="icon pull-left"><img src="/images/icons/1.png" alt="Icon" class="img-responsive"></span>
                              <h4>
                                  <b style="margin-left:10px;">  Profile  Information </b>

                              </h4>


                          </div>



                          <div class="tr-account section-padding">

                              <div class="row">
                                  <div class="col-md-12">
                                      <div class="user-account">
                                          <!-- Nav tabs -->
                                          <ul class="nav nav-tabs  nav-justified" role="tablist">
                                              <li role="presentation" class="active"><a href="#create" aria-controls="seeker" role="tab" data-toggle="tab">Update Profile</a></li>

                                              {{!-- <li role="presentation"><a href="#update" aria-controls="seeker" role="tab" data-toggle="tab"> Update Profile</a></li> --}}

                                              <li role="presentation"><a href="#categories" aria-controls="employers" role="tab" data-toggle="tab">Update Job Categories</a></li>
                                          </ul>

                                          <!-- Tab panes -->
                                          <div class="tab-content">

                                              <div id="create" role="tabpanel" class="tab-pane active">
                                                  <div style="margin-top:20px;" id="profileCreateDiv">

                                                      <input type="hidden" id="UserId" value="{{userDetails._id}}">


                                                      <form action="/user/Profile" method="post" class="profileForm tr-form">

                                                          <div class="form-group ">
                                                              <input type="text" class="form-control" value="{{ userProfile.fullname }}" placeholder="Full Name" name="profile.FullName" id="fullname">
                                                          </div>

                                                          <div class="form-group form-inline">
                                                              <input type="text" class="form-control" value="{{ userProfile.level }}" id="level" placeholder="Level" name="">
                                                              <input type="text" class="form-control" value="{{ userProfile.department }}" id="department" placeholder="Department" name="">
                                                              <input type="text" class="form-control" value="{{ userProfile.faculty }}" id="faculty" placeholder="Faculty" name="">
                                                          </div>

                                                          <div class="form-group">
                                                              <input type="text" class="form-control" value="{{ userProfile.address }}" id="address" placeholder="Address" name="profile.Address">
                                                          </div>

                                                          <div class="form-group form-inline">
                                                              <input type="text" class="form-control" id="city" value="{{ userProfile.city }}" placeholder="City" name="">
                                                              <input type="text" class="form-control" id="state" value="{{ userProfile.state }}" placeholder="State" name="">
                                                          </div>

                                                          {{!-- <div class="form-group">
                                                              <input type="text" class="form-control" placeholder="Facebook Url" name="">
                                                              <input type="text" class="form-control" placeholder="Instagram Url" name="">
                                                              <input type="text" class="form-control" placeholder="Twitter Url" name="">
                                                          </div> --}}

                                                          <div class="form-group">
                                                              <textarea cols="80" type="text" class="form-control" id="about" name="" hidden="AboutMe" placeholder="About Me">{{ userProfile._about }}</textarea>
                                                          </div>

                                                          <div>
                                                              <input type="text" class="form-control" value="{{ userProfile.whatsapp }}" id="whatsapp" placeholder="WhatsApp Number" name="">
                                                          </div>

                                                          <div>
                                                              <button type="submit" id="submit" class="btn btn-primary">Update Profile</button>
                                                          </div>
                                                      </form>
                                                  </div>
                                              </div>


                                              <div role="tabpanel" class="tab-pane" id="update">

                                                  <div style="margin-top:20px;" id="profileEditDiv">

                                                      <form action="/Member/Profile" method="post" class="tr-form">

                                                          <input type="hidden" value="" name="" />
                                                          <div class="form-group ">
                                                              <input type="text" class="form-control" placeholder="Full Name" value="" name="">
                                                          </div>

                                                          <div class="form-group form-inline">
                                                              <input type="text" class="form-control" placeholder="Level" value="" name="">
                                                              <input type="text" class="form-control" placeholder="Department" value="" name="">
                                                              <input type="text" class="form-control" placeholder="Faculty" value="" name="">
                                                          </div>

                                                          <div class="form-group">
                                                              <input type="text" class="form-control" placeholder="Address" value="" name="">
                                                          </div>

                                                          <div class="form-group form-inline">
                                                              <input type="text" class="form-control" placeholder="City" value="" name="">
                                                              <input type="text" class="form-control" placeholder="State" value="" name="">
                                                          </div>

                                                          <div class="form-group">
                                                              <input type="text" class="form-control" placeholder="Facebook Url" value="" name="">
                                                              <input type="text" class="form-control" placeholder="Instagram Url" value="" name="">
                                                              <input type="text" class="form-control" placeholder="Twitter Url" value="" name="">
                                                          </div>

                                                          <div class="form-group">
                                                              <textarea cols="80" type="text" class="form-control" value="" name=""></textarea>
                                                          </div>

                                                          <div>
                                                              <input type="text" class="form-control" placeholder="WhatsApp Number" value="">
                                                          </div>

                                                          <div>
                                                              <input type="submit" class="btn btn-primary" value="Update Profile">
                                                          </div>
                                                      </form>


                                                  </div>

                                              </div>



                                              <div role="tabpanel" class="tab-pane" id="categories">
                                                  <div class="account-content">
                                                      <form action="#" class="tr-form">

                                                          <div class="title title-after" id="MyCategoriesDiv">

                                                              <div style="background-color:dodgerblue; color:white;padding:10px; margin-bottom:20px;">
                                                                  <h4><b>Your Existing Job Categories </b></h4>
                                                              </div>
                                                              {{#if hasServices}}
                                                                <table id="MyCategories" class="table table-striped">
                                                                  <thead>
                                                                      <tr class="row" style="font-weight:bold;">
                                                                          
                                                                          <td class="col-md-4"> Category Name</td>
                                                                          <td align="center" class="col-md-2"> Action</td>

                                                                      </tr>
                                                                  </thead>
                                                                  <tbody style="color:black;">
                                                                    {{#each services as |service|}}
                                                                      <tr class="row">
                                                                            <td class="col-md-6"><i class="fa fa-star" style="margin-right:10px;"></i> {{service.name}} </td>
                                                                            
                                                                            <td class="col-md-2"> <button type="button" onclick="removeService(this,'{{service.id}}')" class="btn-link js-delete">Delete</button></td>
                                                                        </tr>
                                                                    {{/each}}
                                                                          
                                                                  </tbody>
                                                              </table>
                                                              {{else}}
                                                                <p>No service has been added yet, update your profile</p>
                                                              {{/if}}
                                                              
                                                          </div>


                                                          <div>

                                                              <div style="background-color:dodgerblue; color:white;padding:10px; margin-bottom:20px;">
                                                                  <h4>
                                                                      <b>Add New Job Categories</b>

                                                                  </h4>
                                                              </div>
                                                                    <div class="form-group">
                                                                            <select name="services[]" id="services" multiple="multiple">
                                                                              <option value=""></option>
                                                                              {{#each allServices as |service|}}
                                                                                <option value="{{service.id}}">{{service.name}}</option>
                                                                              {{/each}}                       
                                                                            </select>
                                                                    </div>
                                                                  <div class="form-group">
                                                                      <input id="addServices" type="submit" class="btn btn-primary" value="Add Categories">
                                                                  </div>
                                                          
                                                              </div>


                                                      </form>

                                                  </div>
                                              </div>
                                          </div>
                                      </div>
                                  </div>
                              </div><!-- /.row -->
                              <!-- container -->
                          </div><!-- /.tr-account-->





                      </div>
                  </div>
         </div>

         <div id="JobSeeker_View">

              
                <div>


                    <div class="page-title blueback" style="padding:30px; border-radius: 5px 5px 5px 5px;">
                        <h3> Browse Members to Hire </h3>
                    </div>


                    <div class="job-topbar seperator">
                        <span class="pull-left">{{userCount}}  Members</span>
                        <ul class="nav nav-tabs job-tabs" role="tablist">
                            <li>{{serviceCount}} Total Job Categories</li>
                            <li role="presentation" class="active"><a href="#four-colum" aria-controls="four-colum" role="tab" data-toggle="tab"><i class="fa fa-th" aria-hidden="true"></i></a></li>
                            <li role="presentation"><a href="#two-column" aria-controls="two-column" role="tab" data-toggle="tab"><i class="fa fa-th-list" aria-hidden="true"></i></a></li>
                        </ul>
                    </div>

                  



                        <hr />

                        <div class="banner-form"> <hr />

                            <form action="/user/search" method="get">

                                <select id="SchoolId" name="SchName" class="form-control dropdown tr-change-dropdown round">
                                    <option value="">Select Campus</option>
                                    {{#each schools as |school|}}
                                      <option value="{{school._id}}">{{school.name}}</option>
                                    {{/each}}
                                  </select>

                                  <input id="services" list="serviceList" placeholder="Type In Search Categories" name="CategoryName" class="form-control NoRound" />
                                  <datalist id="serviceList">
                                    {{#each allServices as |service|}}
                                      <option value="{{service.name}}">
                                    {{/each}}
                                  </datalist>

                                <!-- @Html.DropDownListFor(m => m.sch.SchoolId, new SelectList(Model.Schools.ToList(), "SchName", "SchName"), "Select Campus", new { @class = "dropdown tr-change-dropdown round" })



                                @Html.TextBoxFor(m => m.category.CategoryName, "Type In Search Categories", new { @class = "form-control NoRound", id = "searchText" }) -->

                              
                                <button type="submit" class="btn btn-primary" value="Search" id="search">Search</button>

                                {{!-- <input type="hidden" id="IsSubscribe" name="IsSubscribe" value="Sub" /> --}}
                          </form>

                        </div><!-- /.banner-form -->


                   
                        <div class="alert alert-danger" role="alert">
                            Sorry  !!! , You Don't have an Active Subscription.  <a href="@Url.Action("Subscription","Member")" class="alert-link">Proceed To Payment</a>
                        </div>

                        <input type="hidden" id="IsSubscribe" name="IsSubscribe" value="NoSub" />
                   



                    <div role="tabpanel" class="tab-pane apply-job  seperator" id="archived">


                        <div id="Categories"></div>

                    </div><!-- /.tab-pane -->




                </div>



         </div>

        
         <div id="SubscriptionManage_View" class="displayinformation">

          
                  <div >

                      <div class="page-title blueback secColor whitefont">
                          <h3 class="myTitle"> Member  Subscriptions </h3>
                      </div>


                      <div class="user-account">
                        <!-- Nav tabs -->
                        <ul class="nav nav-tabs LR_Padding  nav-justified" role="tablist">
                            <li role="presentation" class="active"><a href="#createsub" aria-controls="seeker" role="tab" data-toggle="tab">Subscribe</a></li>

                            <li role="presentation"><a href="#viewsub" aria-controls="seeker" role="tab" data-toggle="tab"> View Subscription History</a></li>

                              </ul>

                        <!-- Tab panes -->
                        <div class="tab-content  LR_Padding">

                            <div id="createsub" role="tabpanel" class="tab-pane active">

                                <div style="margin-top:20px;" id="profileCreateDiv">

                                    <form class="tr-form" style="margin-top:40px;">
                                        <!-- <script src="https://js.paystack.co/v1/inline.js"></script> -->
                                        <button class="btn btn-primary" type="button" onclick="payWithPaystack()"> Pay Now  </button>
                                    </form>

                                   </div>
                            </div>


                            <div role="tabpanel" class="tab-pane" id="viewsub">

                                <div class="account-content">
                                    <form action="#" class="tr-form">

                                        <div class="title title-after" id="MyCategoriesDiv">

                                            <div style="background-color:#2c1106; color:white;padding:10px; margin-bottom:20px;">
                                                <h4><b>Your Subscription History  </b></h4>
                                            </div>
                                            <table id="MyCategories" class="table table-striped">
                                                <thead>
                                                    <tr class="row" style="font-weight:bold;">

                                                       
                                                        <td class="col-md-3"> Transaction Id </td>
                                                        <td class="col-md-2"> Amount </td>
                                                        <td class="col-md-2"> Payment Date </td>
                                                        <td class="col-md-2"> Expiry Date </td>
                                                        <td class="col-md-2" align="center"> Action</td>

                                                    </tr>
                                                </thead>
                                                <tbody style="color:black;">

                                                  
                                                    <tr class="row">

                                                      
                                                        <td class="col-md-3">  item.TransactionId </td>
                                                        <td class="col-md-3">  item?.Amount </td>
                                                        <td class="col-md-2">  item?.PaymentDate </td>
                                                        <td class="col-md-2">  item?.ExpiryDate </td>
                                                        <td class="col-md-2" align="center"> <button data-category-id="item?.Id" class="btn-link js-delete">Delete</button></td>

                                                    </tr>
                                                    
                                                </tbody>
                                            </table>
                                        </div>





                                    </form>


                                </div>

                            </div>



                           
                        </div>
                    </div>


                    



                  </div>



         </div>


       


         
          </div>
        </div>
      </div>
    </div>


  
    <script
      src="https://code.jquery.com/jquery-2.2.3.min.js"
      integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo="
      crossorigin="anonymous"
    ></script>

    <script src="https://js.paystack.co/v1/inline.js"></script>

    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
    <script>
        $('#upload').click(function(){
          $('#profile_pic').trigger('click');
        })
        $('#services').select2({
          placeholder: "Select Services you offer",
          width: "100%"
        })

        $('.profileForm').submit(function(e){
          e.preventDefault();
          const user = {
                 "fullname": $('#fullname').val(),
                 "level": $('#level').val(),
                 "department": $('#department').val(),
                 "faculty": $('#faculty').val(),
                 "address": $('#address').val(),
                 "city": $('#city').val(),
                 "state": $('#state').val(),
                 "_about": $('#about').val(),
                 "whatsapp": $('#whatsapp').val(),
                 "user" : $('#UserId').val()
             };
        
          $.post('/user/profile',user,function(data){
            console.log(data);
                if(data['status']){
                  swal('Great!','Profile updated successfully','success').then(()=> {
                    location.reload(true);
                  });
                }else{
                  swal('huh!',data['message'],'error');
                }
              
             })
        })

        $('#addServices').click(function(e){
          e.preventDefault();
          const services = $('#services').val();
          if(services && services.length > 0){
            $.post('/user/add_services',{
            "services[]": services,
            "user_id" : $('#UserId').val()
            }, function(data){
              if(data['status']){
                swal('Great!','Your Services have been updated successfully','success').then(()=> {
                  location.reload(true);
                });
              }else{
                swal('huh!',data['message'],'error');
              }
            })
          }else{
            swal('huh!','No service was selected','error');
          }
          
        });

        function removeService(btn, service_id){
          $.post('/user/remove_service',{
            "user_id" : $('#UserId').val(),
            service_id
          }, function(data){
            if(data['status']){
              $(btn).parent().parent().fadeOut('slow');
              $(`#${service_id}`).fadeOut('slow');
            }else{
              swal(data['message']);
            }
          })
        }
         
    
    </script>

  
  </body>
</html>
